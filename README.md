# Face Mesh for OBS

這是一個專為OBS Studio設計的Face Mesh瀏覽器源，使用MediaPipe Face Mesh技術實時追蹤面部表情並創建3D網格。

## 功能特點

### 🎯 實時面部追蹤
- 使用MediaPipe Face Mesh追蹤468個面部特徵點
- 實時檢測面部表情變化
- 支援眼睛開合、嘴巴開合等表情識別

### 🎨 雙模式顯示
- **2D模式**: 在視訊上疊加面部網格和特徵點
- **3D模式**: 創建3D面部網格，支援立體視覺效果

### ⚙️ 豐富的控制選項
- 網格透明度調整
- 自定義網格顏色
- 線條寬度控制
- 面部追蹤靈敏度調整
- 顯示/隱藏面部特徵點
- 顯示/隱藏網格線條
- 平滑追蹤選項

### 🎮 操作控制
- 一鍵切換2D/3D模式
- 相機重置功能
- 全螢幕模式
- 快捷鍵隱藏控制面板 (按H鍵)

## 安裝說明

### 推薦使用方法: 官方版本
1. 下載 `face-mesh-official.html` 文件（基於官方MediaPipe示例，最穩定）
2. 在OBS Studio中添加"瀏覽器源"
3. 選擇"本地文件"並選擇 `face-mesh-official.html`
4. 設定寬度和高度（建議1920x1080或1280x720）

### 其他版本
- **`face-mesh-official.html`**: 基於官方MediaPipe示例，最穩定版本 ⭐
- **`simple-face-mesh.html`**: 簡化版本，改進了依賴庫載入
- **`face-mesh-stable.html`**: 完整功能版本，包含3D模式
- **`obs-test.html`**: 測試版本
- **`index.html`**: 原始完整版本

### 本地伺服器（推薦）
1. 將文件放在本地伺服器目錄中
2. 啟動本地伺服器：
   ```bash
   # 使用Python
   python -m http.server 8000
   
   # 或使用Node.js
   npm run start-node
   ```
3. 在OBS中添加瀏覽器源，URL設為 `http://localhost:8000/face-mesh-official.html`

## 使用說明

### 首次使用
1. 允許瀏覽器訪問相機
2. 等待面部追蹤初始化完成
3. 調整控制面板中的參數以獲得最佳效果

### 控制面板說明
- **顯示模式**: 切換2D和3D顯示模式
- **網格透明度**: 調整網格線條的透明度（0-1）
- **網格顏色**: 選擇網格線條的顏色
- **線條寬度**: 調整網格線條的粗細（0.1-5）
- **面部追蹤靈敏度**: 調整追蹤的敏感度（0.1-1）
- **顯示面部特徵點**: 開關面部特徵點的顯示
- **顯示網格**: 開關網格線條的顯示
- **平滑追蹤**: 啟用平滑追蹤以減少抖動

### 快捷鍵
- **H鍵**: 隱藏/顯示控制面板
- **F11**: 全螢幕模式（瀏覽器標準）

## 技術規格

### 依賴庫
- MediaPipe Face Mesh (v0.4.1633559619)
- Three.js (r128) - 3D渲染
- MediaPipe Camera Utils
- MediaPipe Drawing Utils

### 系統要求
- 支援WebRTC的現代瀏覽器
- 相機權限
- 建議使用HTTPS或localhost環境

### 性能優化
- 實時FPS顯示
- 可調整的追蹤靈敏度
- 平滑追蹤選項
- 自適應網格更新

## 故障排除

### 常見問題

**Q: 相機無法啟動**
A: 確保瀏覽器有相機權限，檢查相機是否被其他應用程式佔用

**Q: 面部追蹤不準確**
A: 調整"面部追蹤靈敏度"參數，確保光線充足

**Q: 3D模式顯示異常**
A: 檢查瀏覽器是否支援WebGL，嘗試重新載入頁面

**Q: 性能較差**
A: 降低相機解析度，關閉不必要的顯示選項

**Q: 依賴庫載入失敗 (404錯誤)**
A: 使用 `simple-face-mesh.html` 版本，它使用更穩定的依賴庫載入方式

**Q: Camera 變數未定義錯誤**
A: 這是MediaPipe依賴庫載入問題，使用簡化版本或確保網路連接穩定

### 錯誤代碼
- 相機訪問失敗: 檢查權限設定
- 初始化失敗: 檢查網路連接和依賴庫載入
- 面部追蹤失敗: 檢查相機和光線條件
- 依賴庫載入失敗: 使用簡化版本或檢查網路連接

### 解決方案優先級
1. **首選**: 使用 `simple-face-mesh.html`（最穩定）
2. **備選**: 使用本地伺服器運行 `face-mesh-stable.html`
3. **最後**: 嘗試修復網路依賴庫問題

## 自定義開發

### 修改網格樣式
在 `face-mesh.js` 中修改 `createFaceMesh3D()` 方法來調整3D網格的外觀。

### 添加新的表情識別
在 `adjustMeshForExpression()` 方法中添加新的表情檢測邏輯。

### 修改面部特徵點連接
在 `drawFaceMeshLines()` 方法中調整 `connections` 陣列來修改網格線條的連接方式。

## 授權

本專案使用MIT授權，可自由使用、修改和分發。

## 貢獻

歡迎提交Issue和Pull Request來改進這個專案！

## 更新日誌

### v1.0.0
- 初始版本發布
- 支援2D和3D面部網格顯示
- 實時面部表情追蹤
- 完整的控制面板
- OBS瀏覽器源整合

---

**注意**: 此專案需要網路連接來載入MediaPipe依賴庫。建議在生產環境中將依賴庫下載到本地以確保穩定性。
